''''
' SCRIPTING HANDLERS
''''
Set objApp = CreateObject("Shell.Application") 'setup application handlr
Set objShell = CreateObject("WScript.Shell") 'setup scripting handler
Set objFSO = CreateObject("Scripting.FileSystemObject") 'setup file system handler

''''
' STRING VARIABLES
''''
Dim strLocal: strLocal = objShell.ExpandEnvironmentStrings("%LOCALAPPDATA%")
Dim strPath: strPath = strLocal & "\Google\Chrome\User Data"
Dim strChrome: strChrome = strPath & "\Default"
Dim strCmd: strCmd = "taskkill /F /IM Chrome.exe"

''''
' USER CONFIRMATION
''''
intAnswer = MsgBox("Are you sure? This will restart Chrome. Please save any work before continuing.", vbYesNo + vbQuestion, "Question")

If intAnswer = vbNo Then
	'user doesn't want to continue; exit the script.
	Wscript.Quit
End If

'otherwise, user selected 'Yes'
'silently kill Chrome.exe and wait for completion
objShell.Run strCmd, 0, true

'wait 2 seconds to ensure completion is reached
Wscript.Sleep 2000

''''
' LET'S GET DOWN TO BUSINESS
''''

'check if Chrome data folder exists
If objFSO.FolderExists(strChrome) Then
	'clear all browser data
	objFSO.DeleteFolder strChrome
	
	'restart Chrome.exe
	objShell.Run "Chrome.exe"
	
	'show user success
	MsgBox "Cleared browser data", vbInformation, "Success"
Else
	'show user fail
	MsgBox "Couldn't find Chrome data folder", vbError, "Validation Error"
End If
