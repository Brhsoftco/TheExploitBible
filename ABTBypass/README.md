# Getting around USB executable blocks
### A certain school in a certain town knows this all too well...

A while ago, I found a way to get around USB blocks that work via popular classroom management software. Sometimes, schools employ specialisd software suites that serve to monitor and 'protect' school ICT equipment, the catch is that it's very strict and is simply invasive to say the least.
 One such solution that pretty much rules the roost when it comes to system affordability and usability is AB Tutor by Globe Microsystems (AB Consulting). To give you an idea of
 why I personally hate this piece of software, here are some examples of the evil it commits:
 
 - Allows moderators to remotely view your screen at any time, for any reason.
 - Allows moderators to set policies, block apps and kick you out of apps.
 - Allows moderators to 'lock' your screen via the Win32 API on Windows, Guided Access on iOS (it needs a separate app), and some obscure framework on macOS.

On a side-note, how does it do this? Simple. It shows a fullscreen window via [Qt](https://www.qt.io/), then it disables all known shortcuts to stop the user from trying to escape the form. Some shortcuts include:
- *Any* press of the Windows key that can be handled; e.g. Win+L (lock the current session).
- Ctrl+Alt+Del (WinLogon Service Menu)
- Ctrl-Shift-Esc (Task Manager)
- Alt+F4 (exit the open app)
- Alt+Tab (Window Manager)

 Contrary to popular belief, AB Tutor doesn't kill *all* inputs. My tests show that Windows security doesn't allow complete lockdown of input...so your inputs are still active because of
 Ring 0 isolation, but they've just hooked all button inputs that might cause trouble.
 
 **Now, how do we get around this?**

The answer is simple: we trick the program. On every school, work or other computing system there are basically folders that get ignored by AB Tutor; this is great news. There are few potential hitpoints we can use:

- %ALOCALAPPDATA%\Temp
- C:\<a_random_directory>
- D:\<a_random_directory>

Now, here's an explanation for the above. In our imaginary operating environment, we'll take Education Queensland (DET) computers as an example. All of the deployed operating systems on Queensland Public School systems run what is essentially a prefab image that gets deployed via PXE. This image is known as the Managed Operating Environment (MOE; pronounced 'Mow-e'). The drive layout looks something like this:

- C: (Local Disk)
- D: (Data)
- H: (<UserName>/Documents)

When the latter is mapped, the image is configured to reroute all of the built-in 'special folders' to the network drive. In other words, your Downloads, Documents, Music and Video files are rerouted to their equivalent folders on the network - this makes monitoring easier and hence, it's easier to get caught. Usually, all drives are stored on a server formatted that has its Machine name formatted like so:

`eq<DomainAcronym><SchoolCode><ServerNumber>`

E.g. `eqcen1234001`
