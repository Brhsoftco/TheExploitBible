# Does your workplace/school employ PaperCut MF/NG?
### If you answered yes, then you may be able to exploit it.

Unfortunately for PaperCut, there's actually nothing they can do to patch it - this is an infrastructural exploitation, which means a fix from their end isn't possible.

#### For reference, PaperCut works like this:

- `WORKSTATION-22` sends `JobReport.docx` to the print spooler
- The driver installed for the printer (MFC device, usually) points the spooler to a networked printer
- The location is **always** on a server, and this printer will be created via a 'printer share'
- Certain user groups will be appointed access to a particular 'share' allowing them to submit jobs and 'see' the printer
- Up until this point, everything is native LDAP/Active Directory technology that has been in service for many, many years
- Where things change, however, is the PaperCut auditing service. It works like this:
  - The physical server has the `PaperCut Server` installed on it (usually over the top of Windows Server as a background service)
  - When it's set up, the service places 'hooks' on all the print queues ('printer shares') that are available
  - Then, it scans the LDAP/Active Directory configuration to sync up with the existing user structure of the network
  - When a job is submitted to the vanilla queue, it will contain the default information:
    - How many pages
    - Print type: colour or grayscale
    - The user's AD/LDAP authorisation for that share (includes username and machine name)
    - The raw print data itself
  - Upon arriving in the queue, the PaperCut service will halt the job for processing, and it does this like so:
    - Using the Win32 hook placed on the print queue, it orders the job to stop
    - It looks at the data above, then performs a scan of the 'pricing table' to determine how much the job costs
    - Using the authorisation data from the job, it bills the user.
    - If the user lacks sufficient credit, it orders deletion of the job and sends an alert to the 'PaperCut Client' that's installed on the workstation of origin.
    - If the user has sufficient credit, their balance is debited and the job is 'released'; that is, it is finally sent to the printer.
    
If you are good with basic networking, you'll notice one **severe** problem with this layout...it relies too heavily on the server. What's to stop a direct print job to the printer itself? Probably nothing.

This is the fatal flaw with PaperCut - it relies on admins to stop this phenomenon and properly disable IP printing.

**Wait, IP printing?**

Allow me to explain. Printers (like computers) are assigned IP addresses and are permitted to send and receive data. 
This is good for the network, and good for the normal operation of the printer - except, of course, if it isn't configured correctly. You see, printers accept print jobs if you send a print job *directly* to them using their IP and port information. 
Normally, this is easily obtainable via the printer's menu (like on Konica Minolta MFC's) since you only need the IP address; the port is assumed by the OS.

#### How is this even possible?
PaperCut *needs* the server's resources to audit your print job, and this simply isn't possible using IP printing. The printer itself is isolated from the server during IP printing, and thus doesn't know how to report billing information.

#### But it has PaperCut on the printer's screen!
This is purely a client (like on the workstations you use to submit jobs). The client cannot monitor IP printing jobs that aren't submitted via the usual channel - the server. If you're worried, try submitting a small IP printing job, or a 'test page' from your OS's printing troubleshooter.
